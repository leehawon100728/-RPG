<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê·¼ë³¸ RPG - ìµœì¢…ì¥</title>
    <style>
        body { background: #121212; color: #dcdcdc; font-family: 'Malgun Gothic', sans-serif; display: flex; flex-direction: column; align-items: center; min-height: 100vh; margin: 0; padding: 20px; }
        #game { width: 100%; max-width: 450px; background: #1c1c1c; padding: 25px; border-radius: 5px; border: 2px solid #3a3a3a; box-shadow: 0 0 20px rgba(0,0,0,0.8); }
        .header { text-align: center; border-bottom: 2px solid #3a3a3a; padding-bottom: 15px; margin-bottom: 20px; }
        .stats { display: flex; justify-content: space-between; font-size: 15px; background: #252525; padding: 12px; border: 1px solid #444; margin-bottom: 20px; }
        .weapon-box { text-align: center; padding: 20px; background: #000; border: 1px solid #444; margin-bottom: 15px; }
        .monster-area { background: #2d0000; padding: 15px; border: 1px solid #600; margin-bottom: 15px; text-align: center; }
        .hp-bar { height: 12px; background: #333; border: 1px solid #555; margin-top: 10px; overflow: hidden; }
        #hp-fill { height: 100%; background: #c0392b; width: 100%; transition: 0.1s; }
        .inventory { background: #151515; border: 1px solid #444; padding: 10px; margin-top: 15px; display: none; max-height: 250px; overflow-y: auto; }
        .inv-item { display: flex; justify-content: space-between; align-items: center; padding: 8px; border-bottom: 1px solid #333; font-size: 12px; }
        .btn-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; }
        button { padding: 12px; border: 1px solid #555; background: #333; color: #eee; font-weight: bold; cursor: pointer; transition: 0.1s; }
        button:active { transform: scale(0.98); }
        .atk-btn { background: #4b4b4b; grid-column: span 2; font-size: 18px; border-color: #888; }
        #log { height: 80px; background: #080808; border: 1px solid #333; padding: 10px; font-size: 12px; overflow-y: auto; margin-top: 15px; color: #999; line-height: 1.5; }
        .type-tag { font-size: 10px; padding: 2px 5px; border-radius: 3px; background: #444; margin-right: 5px; color: #fff; }
        .rank-Common { color: #aaa; } .rank-Rare { color: #3498db; } .rank-Epic { color: #9b59b6; } .rank-Legendary { color: #f1c40f; text-shadow: 0 0 5px gold; }
        .admin-box { margin-top: 15px; display: flex; gap: 5px; width: 100%; }
        .admin-input { flex: 1; background: #000; border: 1px solid #444; color: #0f0; padding: 8px; font-family: monospace; font-size: 12px; }
    </style>
</head>
<body>

<div id="game">
    <div class="header"><h1>ê·¼ë³¸ RPG : ìµœì¢…ì¥</h1></div>
    <div class="stats">
        <span>ğŸ’° ê³¨ë“œ: <b id="gold" style="color: #f1c40f;">0</b></span>
        <span>âš”ï¸ ì „íˆ¬ë ¥: <b id="atk" style="color: #ff4757;">15</b></span>
    </div>

    <div class="weapon-box">
        <div id="w-rank">RANK</div>
        <div><span id="w-type" class="type-tag">TYPE</span><b id="w-name" style="font-size:20px;">ì¥ë¹„ ì—†ìŒ</b></div>
        <div id="w-enchant" style="color: #4cd137; font-size: 18px; margin-top:5px;">+0</div>
    </div>

    <div class="monster-area">
        <div id="m-name" style="font-weight:bold;">ëª¬ìŠ¤í„° (Lv.1)</div>
        <div id="m-weak" style="font-size: 12px; color: #ff7675; margin-top: 5px;">ì•½ì : ë¶„ì„ì¤‘</div>
        <div class="hp-bar"><div id="hp-fill"></div></div>
    </div>

    <div class="btn-grid">
        <button class="atk-btn" onclick="attack()">âš”ï¸ ì‹¬ì—°ì˜ ìˆ˜ë ¨ (ê³µê²©)</button>
        <button onclick="enchant()">ğŸ”¥ ì¥ë¹„ ê°•í™”</button>
        <button onclick="gacha()">âœ¨ ìœ ë¬¼ ë°œêµ´</button>
        <button onclick="toggleInv()" style="grid-column: span 2; background: #252525;">ğŸ’ ì¸ë²¤í† ë¦¬ ì—´ê¸° / ë‹«ê¸°</button>
    </div>

    <div id="inventory" class="inventory">
        <div style="font-size:12px; color:#f1c40f; margin-bottom:10px; border-bottom:1px solid #444;">ë³´ìœ  ì•„ì´í…œ ëª©ë¡</div>
        <div id="inv-list"></div>
    </div>

    <div id="log">> ëŒ€ë¥™ì˜ ë¶€ë¦„ì— ì‘ë‹µí•˜ì‹­ì‹œì˜¤.</div>

    <div class="admin-box">
        <input type="text" id="adminCode" class="admin-input" placeholder="ìš´ì˜ì ì½”ë“œ ì…ë ¥...">
        <button onclick="checkAdminCode()" style="padding: 0 15px; font-size: 12px; background:#222;">ì ìš©</button>
    </div>
</div>

<script>
    const types = ["ì¹¼", "í™œ", "ì§€íŒ¡ì´", "ê²©íˆ¬"];
    const monsterData = [
        { name: "ë“¤ì¥", weak: "ê²©íˆ¬" },
        { name: "ê³ ë¸”ë¦°", weak: "í™œ" },
        { name: "ìŠ¤ì¼ˆë ˆí†¤", weak: "ì§€íŒ¡ì´" },
        { name: "ì˜¤í¬", weak: "ì¹¼" },
        { name: "í‚¤ë©”ë¼", weak: "ì§€íŒ¡ì´" },
        { name: "ë“œë˜ê³¤", weak: "í™œ" }
    ];

    let state = JSON.parse(localStorage.getItem('rpg_final_save')) || {
        gold: 0, baseAtk: 15, monsterLvl: 1,
        inventory: [{ id: Date.now(), name: "ì´ˆë³´ìì˜ ë‹¨ê²€", rank: "Common", type: "ì¹¼", enchant: 0, power: 10 }],
        equippedId: null
    };

    if(!state.equippedId && state.inventory.length > 0) state.equippedId = state.inventory[0].id;
    let curHp = 50 + (state.monsterLvl * 40);

    function save() { localStorage.setItem('rpg_final_save', JSON.stringify(state)); }

    function updateUI() {
        const weapon = state.inventory.find(i => i.id === state.equippedId) || { name: "ë§¨ì†", rank: "Common", type: "ê²©íˆ¬", enchant: 0, power: 5 };
        document.getElementById('gold').innerText = state.gold.toLocaleString();
        
        const mIdx = Math.min(Math.floor(state.monsterLvl/5), monsterData.length-1);
        const monster = monsterData[mIdx];
        document.getElementById('m-name').innerText = `${monster.name} (Lv.${state.monsterLvl})`;
        document.getElementById('m-weak').innerText = `ğŸ¯ ì•½ì : ${monster.weak} (ê³µê²©ë ¥ 200% ì ìš©)`;

        let bonus = (weapon.type === monster.weak) ? 2 : 1;
        let totalAtk = (state.baseAtk + weapon.power + (weapon.enchant * (weapon.power * 0.2))) * bonus;
        
        document.getElementById('atk').innerText = Math.floor(totalAtk).toLocaleString() + (bonus > 1 ? " (ìƒì„± í­ë°œ!)" : "");
        document.getElementById('w-name').innerText = weapon.name;
        document.getElementById('w-type').innerText = weapon.type;
        document.getElementById('w-rank').innerText = weapon.rank.toUpperCase();
        document.getElementById('w-rank').className = "rank-" + weapon.rank;
        document.getElementById('w-enchant').innerText = "+" + weapon.enchant;
        
        let maxHp = 50 + (state.monsterLvl * 40);
        document.getElementById('hp-fill').style.width = (curHp / maxHp * 100) + "%";
        
        renderInventory();
        save();
    }

    function renderInventory() {
        const list = document.getElementById('inv-list');
        list.innerHTML = state.inventory.map(item => `
            <div class="inv-item">
                <span class="rank-${item.rank}">[${item.type}] ${item.name} (+${item.enchant})</span>
                <button onclick="state.equippedId=${item.id}; updateUI();" style="padding:3px 10px; font-size:11px;">${state.equippedId === item.id ? 'ì¥ì°©ì¤‘' : 'ì¥ì°©'}</button>
            </div>
        `).join('');
    }

    function attack() {
        const weapon = state.inventory.find(i => i.id === state.equippedId) || { power: 5, enchant: 0, type: "ê²©íˆ¬" };
        const mIdx = Math.min(Math.floor(state.monsterLvl/5), monsterData.length-1);
        let bonus = (weapon.type === monsterData[mIdx].weak) ? 2 : 1;
        let damage = (state.baseAtk + weapon.power + (weapon.enchant * (weapon.power * 0.2))) * bonus;
        
        curHp -= damage;
        if (curHp <= 0) {
            let earn = 20 + (state.monsterLvl * 10);
            state.gold += earn;
            state.monsterLvl++;
            curHp = 50 + (state.monsterLvl * 40);
            log(`ìŠ¹ë¦¬! ${earn}Gë¥¼ íšë“í–ˆìŠµë‹ˆë‹¤.`);
        }
        updateUI();
    }

    function enchant() {
        let weapon = state.inventory.find(i => i.id === state.equippedId);
        if(!weapon) return log("ë¬´ê¸°ë¥¼ ë¨¼ì € ì¥ì°©í•˜ì„¸ìš”.");
        let cost = 100 + (weapon.enchant * 70);
        if (state.gold < cost) return log("ê³¨ë“œê°€ ë¶€ì¡±í•©ë‹ˆë‹¤.");
        state.gold -= cost;

        let chance = Math.max(2, 90 - (weapon.enchant * 7));
        if (Math.random() * 100 < chance) {
            weapon.enchant++;
            log(`ê°•í™” ì„±ê³µ! +${weapon.enchant} ìˆ˜ì¹˜ë¥¼ ë‹¬ì„±í–ˆìŠµë‹ˆë‹¤.`);
        } else {
            log("ê°•í™” ì‹¤íŒ¨... (ìˆ˜ì¹˜ëŠ” ìœ ì§€ë˜ì—ˆìŠµë‹ˆë‹¤)");
        }
        updateUI();
    }

    function gacha() {
        if (state.gold < 500) return log("ë°œêµ´ ë¹„ìš©ì´ ë¶€ì¡±í•©ë‹ˆë‹¤.");
        state.gold -= 500;
        const rand = Math.random() * 100;
        const type = types[Math.floor(Math.random() * types.length)];
        let rank = "Common", power = 10, name = "ë…¹ìŠ¨ " + type;

        if (rand < 1.5) { rank = "Legendary"; power = 450; name = type === "ì¹¼" ? "ì‹ í™”ì˜ ì¢…ë§" : type === "í™œ" ? "ì²œê³µì˜ ë‚ ê°œ" : type === "ì§€íŒ¡ì´" ? "ê¸ˆì§€ëœ ì˜ˆì–¸" : "ì‹ ì˜ ê¶ŒëŠ¥"; }
        else if (rand < 8) { rank = "Epic"; power = 160; name = "ì™•ì‹¤ " + type; }
        else if (rand < 25) { rank = "Rare"; power = 60; name = "ê°•í™” " + type; }

        state.inventory.push({ id: Date.now(), name: name, rank: rank, type: type, enchant: 0, power: power });
        log(`[${rank}] ${name}ì„(ë¥¼) ë°œêµ´í–ˆìŠµë‹ˆë‹¤!`);
        updateUI();
    }

    function checkAdminCode() {
        const code = document.getElementById('adminCode').value;
        if (code === "27272727") {
            state.gold += 100000;
            log("ğŸ“¢ ì¹˜íŠ¸ ì½”ë“œ ì ìš©! 100,000G ì§€ì›.");
            document.getElementById('adminCode').value = "";
            updateUI();
        } else { log("âŒ ì˜ëª»ëœ ì•”í˜¸ì…ë‹ˆë‹¤."); }
    }

    function toggleInv() {
        const inv = document.getElementById('inventory');
        inv.style.display = inv.style.display === 'block' ? 'none' : 'block';
    }

    function log(msg) {
        const l = document.getElementById('log');
        l.innerHTML = `<div>> ${msg}</div>` + l.innerHTML;
    }

    updateUI();
</script>
</body>
</html>
