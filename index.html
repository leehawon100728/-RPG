<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê·¼ë³¸ RPG - ë¡œê·¸ì¸ ì‹œìŠ¤í…œ</title>
    <style>
        body { background: #121212; color: #dcdcdc; font-family: 'Malgun Gothic', sans-serif; display: flex; flex-direction: column; align-items: center; min-height: 100vh; margin: 0; padding: 20px; }
        #auth-screen { width: 100%; max-width: 350px; background: #1c1c1c; padding: 30px; border-radius: 10px; border: 1px solid #3a3a3a; margin-top: 50px; }
        #game { display: none; width: 100%; max-width: 450px; background: #1c1c1c; padding: 25px; border-radius: 5px; border: 2px solid #3a3a3a; box-shadow: 0 0 20px rgba(0,0,0,0.8); }
        
        /* ê³µí†µ ì…ë ¥ì°½/ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        input { width: 100%; padding: 12px; margin-bottom: 10px; background: #000; border: 1px solid #444; color: #fff; box-sizing: border-box; }
        button { width: 100%; padding: 14px; border: 1px solid #555; background: #333; color: #eee; font-weight: bold; cursor: pointer; transition: 0.1s; }
        button:hover { background: #444; }
        
        /* ê²Œì„ ë‚´ë¶€ ìŠ¤íƒ€ì¼ */
        .header { text-align: center; border-bottom: 2px solid #3a3a3a; padding-bottom: 15px; margin-bottom: 20px; }
        .stats { display: flex; justify-content: space-between; font-size: 15px; background: #252525; padding: 12px; border: 1px solid #444; margin-bottom: 20px; }
        .weapon-box { text-align: center; padding: 20px; background: #000; border: 1px solid #444; margin-bottom: 15px; }
        .monster-area { background: #2d0000; padding: 15px; border: 1px solid #600; margin-bottom: 15px; text-align: center; }
        .hp-bar { height: 12px; background: #333; border: 1px solid #555; margin-top: 10px; overflow: hidden; }
        #hp-fill { height: 100%; background: #c0392b; width: 100%; transition: 0.1s; }
        .inventory { background: #151515; border: 1px solid #444; padding: 10px; margin-top: 15px; display: none; max-height: 250px; overflow-y: auto; }
        .inv-item { display: flex; justify-content: space-between; align-items: center; padding: 8px; border-bottom: 1px solid #333; font-size: 12px; }
        .btn-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; }
        .atk-btn { background: #4b4b4b; grid-column: span 2; font-size: 18px; }
        #log { height: 80px; background: #080808; border: 1px solid #333; padding: 10px; font-size: 12px; overflow-y: auto; margin-top: 15px; color: #999; }
        .rank-Legendary { color: #f1c40f; text-shadow: 0 0 5px gold; }
        .admin-box { margin-top: 15px; display: flex; gap: 5px; }
    </style>
</head>
<body>

<div id="auth-screen">
    <h2 id="auth-title" style="text-align: center;">RPG ì ‘ì†</h2>
    <input type="text" id="user-id" placeholder="ì•„ì´ë””">
    <input type="password" id="user-pw" placeholder="ë¹„ë°€ë²ˆí˜¸">
    <button id="main-auth-btn" onclick="handleAuth()">ë¡œê·¸ì¸</button>
    <p id="auth-toggle" onclick="toggleAuthMode()" style="text-align:center; font-size:12px; color:#888; cursor:pointer; margin-top:15px;">ê³„ì •ì´ ì—†ìœ¼ì‹ ê°€ìš”? íšŒì›ê°€ì…</p>
</div>

<div id="game">
    <div class="header">
        <h1 style="margin:0; font-size:20px;">ê·¼ë³¸ RPG</h1>
        <span id="player-tag" style="font-size:12px; color:#aaa;">ìš©ì‚¬ë‹˜ í™˜ì˜í•©ë‹ˆë‹¤</span>
    </div>
    
    <div class="stats">
        <span>ğŸ’° ê³¨ë“œ: <b id="gold" style="color: #f1c40f;">0</b></span>
        <span>âš”ï¸ ì „íˆ¬ë ¥: <b id="atk" style="color: #ff4757;">15</b></span>
    </div>

    <div class="weapon-box">
        <div id="w-rank">RANK</div>
        <div><b id="w-name" style="font-size:20px;">ì¥ë¹„ ì—†ìŒ</b></div>
        <div id="w-enchant" style="color: #4cd137;">+0</div>
    </div>

    <div class="monster-area">
        <div id="m-name" style="font-weight:bold;">ëª¬ìŠ¤í„°</div>
        <div class="hp-bar"><div id="hp-fill"></div></div>
    </div>

    <div class="btn-grid">
        <button class="atk-btn" onclick="attack()">âš”ï¸ ì‚¬ëƒ¥í•˜ê¸°</button>
        <button onclick="enchant()">ğŸ”¥ ê°•í™”</button>
        <button onclick="gacha()">âœ¨ ë°œêµ´</button>
        <button onclick="toggleInv()" style="grid-column: span 2;">ğŸ’ ì¸ë²¤í† ë¦¬</button>
        <button onclick="logout()" style="grid-column: span 2; background:#222; font-size:12px; padding:5px; margin-top:10px;">ë¡œê·¸ì•„ì›ƒ</button>
    </div>

    <div id="inventory" class="inventory"><div id="inv-list"></div></div>
    <div id="log">> ì ‘ì† ì™„ë£Œ.</div>
    
    <div class="admin-box">
        <input type="text" id="adminCode" style="margin:0" placeholder="ì¹˜íŠ¸ ì½”ë“œ...">
        <button onclick="checkAdminCode()" style="padding:0 10px; width:80px;">ì ìš©</button>
    </div>
</div>

<script>
    // --- ë¡œê·¸ì¸ ì‹œìŠ¤í…œ ë¡œì§ ---
    let isSignUpMode = false;
    let currentUser = null;

    function toggleAuthMode() {
        isSignUpMode = !isSignUpMode;
        document.getElementById('auth-title').innerText = isSignUpMode ? "íšŒì›ê°€ì…" : "ë¡œê·¸ì¸";
        document.getElementById('main-auth-btn').innerText = isSignUpMode ? "íšŒì›ê°€ì… ì™„ë£Œ" : "ë¡œê·¸ì¸";
        document.getElementById('auth-toggle').innerText = isSignUpMode ? "ì´ë¯¸ ê³„ì •ì´ ìˆë‚˜ìš”? ë¡œê·¸ì¸" : "ê³„ì •ì´ ì—†ìœ¼ì‹ ê°€ìš”? íšŒì›ê°€ì…";
    }

    function handleAuth() {
        const id = document.getElementById('user-id').value;
        const pw = document.getElementById('user-pw').value;
        if(!id || !pw) return alert("ì•„ì´ë””ì™€ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”.");

        if(isSignUpMode) {
            if(localStorage.getItem(`user_${id}`)) return alert("ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ì•„ì´ë””ì…ë‹ˆë‹¤.");
            const userData = { pw: pw, gameData: null };
            localStorage.setItem(`user_${id}`, JSON.stringify(userData));
            alert("íšŒì›ê°€ì… ì„±ê³µ! ë¡œê·¸ì¸í•´ì£¼ì„¸ìš”.");
            toggleAuthMode();
        } else {
            const stored = JSON.parse(localStorage.getItem(`user_${id}`));
            if(!stored || stored.pw !== pw) return alert("ì•„ì´ë”” ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ í‹€ë ¸ìŠµë‹ˆë‹¤.");
            currentUser = id;
            initGame(stored.gameData);
        }
    }

    function logout() { location.reload(); }

    // --- ê²Œì„ ë¡œì§ ---
    let state;
    const monsterData = [{name:"ë“¤ì¥", weak:"ê²©íˆ¬"}, {name:"ì˜¤í¬", weak:"ì¹¼"}, {name:"ë“œë˜ê³¤", weak:"í™œ"}];

    function initGame(savedData) {
        document.getElementById('auth-screen').style.display = 'none';
        document.getElementById('game').style.display = 'block';
        document.getElementById('player-tag').innerText = `ìš©ì‚¬ [${currentUser}]ë‹˜ í™˜ì˜í•©ë‹ˆë‹¤`;

        state = savedData || {
            gold: 0, baseAtk: 15, monsterLvl: 1,
            inventory: [{ id: Date.now(), name: "ë…¹ìŠ¨ ê²€", rank: "Common", type: "ì¹¼", enchant: 0, power: 10 }],
            equippedId: null
        };
        if(!state.equippedId) state.equippedId = state.inventory[0].id;
        updateUI();
    }

    function save() {
        const userData = JSON.parse(localStorage.getItem(`user_${currentUser}`));
        userData.gameData = state;
        localStorage.setItem(`user_${currentUser}`, JSON.stringify(userData));
    }

    // (ê³µê²©, ê°•í™”, ë°œêµ´ ë“± ë‚˜ë¨¸ì§€ ê²Œì„ ë¡œì§ì€ ì´ì „ê³¼ ë™ì¼í•˜ê²Œ ìœ ì§€...)
    function updateUI() {
        const weapon = state.inventory.find(i => i.id === state.equippedId) || state.inventory[0];
        document.getElementById('gold').innerText = state.gold.toLocaleString();
        let totalAtk = state.baseAtk + weapon.power + (weapon.enchant * (weapon.power * 0.2));
        document.getElementById('atk').innerText = Math.floor(totalAtk).toLocaleString();
        document.getElementById('w-name').innerText = weapon.name;
        document.getElementById('w-enchant').innerText = "+" + weapon.enchant;
        
        let curHp = 50 + (state.monsterLvl * 40); // ë‹¨ìˆœí™”ëœ HP ê³„ì‚°
        document.getElementById('m-name').innerText = `ëª¬ìŠ¤í„° (Lv.${state.monsterLvl})`;
        document.getElementById('hp-fill').style.width = "100%";
        
        const list = document.getElementById('inv-list');
        list.innerHTML = state.inventory.map(item => `
            <div class="inv-item">
                <span class="rank-${item.rank}">${item.name} (+${item.enchant})</span>
                <button onclick="state.equippedId=${item.id}; updateUI();" style="width:60px; padding:5px;">ì¥ì°©</button>
            </div>
        `).join('');
        save();
    }

    function attack() {
        state.gold += (10 + state.monsterLvl);
        state.monsterLvl++;
        log(`ì „íˆ¬ ìŠ¹ë¦¬! ë ˆë²¨ ${state.monsterLvl}ë¡œ ìƒìŠ¹.`);
        updateUI();
    }

    function gacha() {
        if(state.gold < 500) return alert("ê³¨ë“œ ë¶€ì¡±!");
        state.gold -= 500;
        const newItem = { id: Date.now(), name: "ë°œêµ´ëœ ë¬´ê¸°", rank: "Rare", type: "ì¹¼", enchant: 0, power: 50 };
        state.inventory.push(newItem);
        updateUI();
    }

    function enchant() {
        let weapon = state.inventory.find(i => i.id === state.equippedId);
        if(state.gold < 100) return alert("ê³¨ë“œ ë¶€ì¡±!");
        state.gold -= 100;
        weapon.enchant++;
        log("ê°•í™” ì„±ê³µ!");
        updateUI();
    }

    function toggleInv() { const inv = document.getElementById('inventory'); inv.style.display = inv.style.display === 'block' ? 'none' : 'block'; }
    function log(m) { const l = document.getElementById('log'); l.innerHTML = `<div>> ${m}</div>` + l.innerHTML; }
    function checkAdminCode() { if(document.getElementById('adminCode').value === "27272727") { state.gold += 100000; updateUI(); } }
</script>
</body>
</html>
